<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>R 快速入门 &mdash; OSGeo-Live 11.0beta
 Documentation</title>
    
    <link rel="stylesheet" href="../../_static/overview.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '11.0beta
',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="OSGeo-Live 11.0beta
 Documentation" href="../../index.html" />
    <link rel="up" title="OSGeo-Live 11.0beta 包含内容一览" href="../overview/overview.html" />
    <link rel="next" title="Atlas Styler 快速入门文档" href="atlasstyler_quickstart.html" />
    <link rel="prev" title="52°North WSS 快速入门" href="52nWSS_quickstart.html" /> 
	<script type="text/javascript" src="../../_static/osgeolive.js"></script>

  </head>
  <body role="document">
    <div class="header">
	<div class="banner"><a href="http://live.osgeo.org/"><img src="../../_images/banner.png"></a></div>
        <div class="nowrap">
            <ul id="top-nav">
              <li><a href="../index.html">Home</a></li>
              <li><a href="../overview/overview.html">Contents</a></li>
              <!--li><a href="../standards/standards.html">Standards</a></li-->
              <li><a href="../download.html">Download</a></li>
              <li><a href="../metrics.html">Metrics</a></li>
              <li><a href="../sponsors.html">Sponsors</a></li>
              <li><a href="../contact.html">Contact Us</a></li>
            </ul>
        </div>
    </div>

    <div class="related">
	<font size="-2">
		<div id="translations">
		<!--
			<a href="../../en/index.html">English</a> |
			<a href="../../es/index.html">Español</a> |
			<a href="../../ca/index.html">Català</a> |
			<a href="../../fr/index.html">Français</a> |
			<a href="../../de/index.html">Deutsch</a> |
			<a href="../../it/index.html">Italiano</a> |
			<a href="../../pl/index.html">Polski</a> |
			<a href="../../el/index.html">Ελληνικά</a> |
			<a href="../../ru/index.html">Русский</a> |
			<a href="../../zh/index.html">中文</a> |
			<a href="../../id/index.html">Bahasa Indonesia</a> |
			<a href="../../ko/index.html">한국어</a> |
			<a href="../../ja/index.html">日本語</a>
		-->
		<!-- geo-order: West to East, UK to Japan -->
			<a href="javascript:defaultRedirect('en')">English</a> |
<!--			<a href="javascript:defaultRedirect('pt')">Portugus</a> | -->
			<a href="javascript:defaultRedirect('es')">Español</a> |
			<a href="javascript:defaultRedirect('ca')">Català</a> |
			<a href="javascript:defaultRedirect('fr')">Français</a> |
			<a href="javascript:defaultRedirect('de')">Deutsch</a> |
			<a href="javascript:defaultRedirect('it')">Italiano</a> |
			<a href="javascript:defaultRedirect('pl')">Polski</a> |
			<a href="javascript:defaultRedirect('el')">Ελληνικά</a> |
			<a href="javascript:defaultRedirect('ru')">Русский</a> |
			<a href="javascript:defaultRedirect('zh')">中文</a> |
<!--			<a href="javascript:defaultRedirect('id')">Bahasa Indonesia</a> | -->
			<a href="javascript:defaultRedirect('ko')">한국어</a> |
			<a href="javascript:defaultRedirect('ja')">日本語</a>
		</div>
	</font>
    </div>


    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <img alt="project logo" class="align-right" src="../../_images/logo-R.png" />
<div class="section" id="r">
<h1>R 快速入门<a class="headerlink" href="#r" title="Permalink to this headline">¶</a></h1>
<p>　　R 是一款用于数据统计和图形运算的自由软件环境。</p>
<p>　　本文演示：</p>
<blockquote>
<div><ul class="simple">
<li>使用 R 进行简单算数运算。</li>
<li>读取 shp 文件并生成地图。</li>
<li>执行坐标转换。</li>
<li>在地图中投出数据点。</li>
</ul>
</div></blockquote>
<div class="section" id="id1">
<h2>启动 R<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li>从 Spatial Tools 菜单选择 <code class="docutils literal"><span class="pre">R</span> <span class="pre">Statistics</span></code> 启动一个命令行窗口。</li>
</ul>
</div></blockquote>
<p>　　或者：</p>
<blockquote>
<div><ul class="simple">
<li>在命令行窗口输入 <code class="docutils literal"><span class="pre">R</span></code> 。</li>
</ul>
</div></blockquote>
<p>　　若您对命令行环境不熟悉，使用上下键调出以前输入的命令可以方便地修改错误。若因为持续运算导致不能执行输入，点击 CTRL-C 即可。</p>
</div>
<div class="section" id="id2">
<h2>退出 R<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>　　几乎 R 中所有的功能都是一个函数，包括退出。输入 <code class="docutils literal"><span class="pre">q()</span></code> 并回车退出。若输入 <code class="docutils literal"><span class="pre">q</span></code> 会显示 <code class="docutils literal"><span class="pre">q</span></code> 函数的源码。</p>
<p>　　系统将询问是否要将数据保存。从一个有 <code class="docutils literal"><span class="pre">.RData</span></code> 文件的目录启动 R 将读取全部的数据。</p>
</div>
<div class="section" id="id3">
<h2>R 基本操作<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>　　R 是一个命令行程序，但也有图形界面可用。在命令行输入一个命令，R 将解释执行并输出结果。</p>
<p>　　例如简单算数</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="mi">3</span><span class="o">*</span><span class="mi">2</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">6</span>

<span class="o">&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">2.5</span>

<span class="o">&gt;</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">1.414214</span>

<span class="o">&gt;</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">1.155727</span>
</pre></div>
</div>
<p>　　基本的算数、三角和统计分析运算都可以执行。另有数千种扩展功能由 <a class="reference external" href="http://cran.r-project.org/">CRAN</a> 提供。</p>
<p>　　R 中基本的命令提示符为 <code class="docutils literal"><span class="pre">&gt;</span></code> 。<code class="docutils literal"><span class="pre">+</span></code> 表示进一步输入的提示。比如用户忘记关闭括号时会显示该提示符。</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">sqrt</span><span class="p">(</span>
<span class="o">+</span> <span class="mi">2</span>
<span class="o">+</span> <span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">1.414214</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h2>创建数据<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>You might be wondering what the mysterious &#8216;one&#8217; in square brackets is
doing in the output. This is telling you that the result is one number. R
can store things in one-dimensional vectors, two-dimensional matrices,
and multi-dimensional arrays. There are many functions that can
generate these things. Here&#8217;s a simple sequence:
　　您可能会好奇前述开方输出前面的“[1]”是什么符号。这个标记在此处表示结果只有一个数值。R 可以存储一维、二维及多维的数列和矩阵。下面是一个简单的等差数列：</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">seq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">1.000000</span> <span class="mf">1.444444</span> <span class="mf">1.888889</span> <span class="mf">2.333333</span> <span class="mf">2.777778</span> <span class="mf">3.222222</span> <span class="mf">3.666667</span> <span class="mf">4.111111</span>
<span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="mf">4.555556</span> <span class="mf">5.000000</span>
</pre></div>
</div>
<p>　　此处 <code class="docutils literal"><span class="pre">[9]</span></code> 表示 4.555 是数列中第 9 个数。</p>
<p>　　创建二维矩阵将得到行列标记：</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">m</span><span class="o">=</span><span class="n">matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">m</span>
     <span class="p">[,</span><span class="mi">1</span><span class="p">]</span> <span class="p">[,</span><span class="mi">2</span><span class="p">]</span> <span class="p">[,</span><span class="mi">3</span><span class="p">]</span> <span class="p">[,</span><span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,]</span>    <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">7</span>   <span class="mi">10</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,]</span>    <span class="mi">2</span>    <span class="mi">5</span>    <span class="mi">8</span>   <span class="mi">11</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,]</span>    <span class="mi">3</span>    <span class="mi">6</span>    <span class="mi">9</span>   <span class="mi">12</span>
</pre></div>
</div>
<p>　　矩阵中的元素可以以行列号标示获取，只取行或列将得到低维矩阵或向量。使用行列号范围可以取矩阵的一部分。</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">11</span>

<span class="o">&gt;</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">,]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="mi">2</span>  <span class="mi">5</span>  <span class="mi">8</span> <span class="mi">11</span>

<span class="o">&gt;</span> <span class="n">m</span><span class="p">[,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
     <span class="p">[,</span><span class="mi">1</span><span class="p">]</span> <span class="p">[,</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,]</span>    <span class="mi">7</span>   <span class="mi">10</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,]</span>    <span class="mi">8</span>   <span class="mi">11</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,]</span>    <span class="mi">9</span>   <span class="mi">12</span>
</pre></div>
</div>
<p>　　Data frame 数据表模型是类似 Postgres 或 MySQL 等关系数据库的数据模型。每行为一个记录，每列为一个字段。每个字段的数据类型对所有记录必须一致。</p>
<p>　　该模型的操作同一般矩阵类似，但字段可以以 $-notation 命令标注名称：</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&gt; d = data.frame(x=1:10,y=1:10,z=runif(10)) # z is 10 random numbers
&gt; d
        x  y          z
    1   1  1 0.44128080
    2   2  2 0.09394331
    3   3  3 0.51097462
    4   4  4 0.82683828
    5   5  5 0.21826740
    6   6  6 0.65600533
    7   7  7 0.59798278
    8   8  8 0.19003625
    9   9  9 0.24004866
    10 10 10 0.35972749

&gt; d$z
 [1] 0.44128080 0.09394331 0.51097462 0.82683828 0.21826740 0.65600533
 [7] 0.59798278 0.19003625 0.24004866 0.35972749

&gt; d$big = d$z &gt; 0.6  # d$big is now a boolean true/false value
&gt; d[1:5,]
  x y          z   big
1 1 1 0.44128080 FALSE
2 2 2 0.09394331 FALSE
3 3 3 0.51097462 FALSE
4 4 4 0.82683828  TRUE
5 5 5 0.21826740 FALSE

&gt; d$name = letters[1:10] # create a new field of characters
&gt; d[1:5,]
  x y          z   big name
  1 1 1 0.44128080 FALSE    a
  2 2 2 0.09394331 FALSE    b
  3 3 3 0.51097462 FALSE    c
  4 4 4 0.82683828  TRUE    d
  5 5 5 0.21826740 FALSE    e
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h2>读取地图数据<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>　　R 包含了大量处理空间操作和空间统计的功能。其中一部分包含在基本系统中，另一些由 CRAN 提供。</p>
<p>　　这里读取两个 shp 文件，分别是 Natural Earth 数据集中的国境线和主要居民点。以下两个软件包在这里提供所需的空间操作能力：</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">library</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">library</span><span class="p">(</span><span class="n">maptools</span><span class="p">)</span>

<span class="o">&gt;</span> <span class="n">countries</span> <span class="o">=</span> <span class="n">readShapeSpatial</span><span class="p">(</span><span class="s2">&quot;/usr/local/share/data/natural_earth2/ne_10m_admin_0_countries.shp&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">places</span> <span class="o">=</span> <span class="n">readShapeSpatial</span><span class="p">(</span><span class="s2">&quot;/usr/local/share/data/natural_earth2/ne_10m_populated_places.shp&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">plot</span><span class="p">(</span><span class="n">countries</span><span class="p">)</span>
</pre></div>
</div>
<p>　　输出为简单的世界地图位图：</p>
<img alt="../../_images/r_plot1.png" src="../../_images/r_plot1.png" />
<p>　　OGR 数据集在 R 中以 data frame 表达。此处通过 <code class="docutils literal"><span class="pre">admin</span></code> 字段可以提取英国部分的数据：</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&gt; uk = countries[countries$admin==&quot;United Kingdom&quot;,]
&gt; plot(uk); axis(1); axis(2)
</pre></div>
</div>
<img alt="../../_images/r_plot2.png" src="../../_images/r_plot2.png" />
<p>　　这样的显示对于英国居民而言不符合习惯，因为数据分布的位置不在图件的中心位置。目前该地图还没有投影信息。此处查询投影：</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">proj4string</span><span class="p">(</span><span class="n">uk</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">NA</span>
</pre></div>
</div>
<p>　　<code class="docutils literal"><span class="pre">NA</span></code> 表示空值。在进行投影转换前必须先指定投影系统。此处需变换至 EPSG:27700 Ordnance Survey of Great Britain 投影：</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">proj4string</span><span class="p">(</span><span class="n">uk</span><span class="p">)</span><span class="o">=</span><span class="n">CRS</span><span class="p">(</span><span class="s2">&quot;+init=epsg:4326&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">library</span><span class="p">(</span><span class="n">rgdal</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">ukos</span> <span class="o">=</span> <span class="n">spTransform</span><span class="p">(</span><span class="n">uk</span><span class="p">,</span><span class="n">CRS</span><span class="p">(</span><span class="s2">&quot;+init=epsg:27700&quot;</span><span class="p">))</span>
<span class="o">&gt;</span> <span class="n">proj4string</span><span class="p">(</span><span class="n">ukos</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="s2">&quot; +init=epsg:27700 +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +datum=OSGB36 +units=m +no_defs</span>
<span class="o">+</span><span class="n">towgs84</span><span class="o">=</span><span class="mf">446.448</span><span class="p">,</span><span class="o">-</span><span class="mf">125.157</span><span class="p">,</span><span class="mf">542.060</span><span class="p">,</span><span class="mf">0.1502</span><span class="p">,</span><span class="mf">0.2470</span><span class="p">,</span><span class="mf">0.8421</span><span class="p">,</span><span class="o">-</span><span class="mf">20.4894</span><span class="s2">&quot;</span>

<span class="o">&gt;</span> <span class="n">plot</span><span class="p">(</span><span class="n">ukos</span><span class="p">);</span><span class="n">axis</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="n">axis</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>　　这样就得到了变换后的底图。对于居民点数据，同样执行转换：</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&gt; ukpop = places[places$ADM0NAME==&quot;United Kingdom&quot;,]
&gt; proj4string(ukpop)=CRS(&quot;+init=epsg:4326&quot;)
&gt; ukpop = spTransform(ukpop,CRS(&quot;+init=epsg:27700&quot;))
</pre></div>
</div>
<p>　　将居民点数据投图，图标尺寸同人口平方根成正比（即面积同人口成正比），颜色为红色，图标为实心点：</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&gt; points(ukpop,cex=sqrt(ukpop$POP_MAX/1000000),col=&quot;red&quot;,pch=19)
&gt; title(&quot;UK Population centre sizes&quot;)
</pre></div>
</div>
<p>　　最终结果：</p>
<img alt="../../_images/r_plot3.png" src="../../_images/r_plot3.png" />
</div>
<div class="section" id="id6">
<h2>功能简介短文<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>　　以往 R 文档只包含对各个功能简单的说明。R 社区鼓励编写被称为 &#8216;vignette&#8217; 的更为友好的短文介绍各个功能。无参数运行 <code class="docutils literal"><span class="pre">vignette()</span></code> 将列出所有可用的 vignette 数据。<code class="docutils literal"><span class="pre">vignette(&quot;intro_sp&quot;)</span></code> 将显示统计功能包的技术说明，<code class="docutils literal"><span class="pre">vignette(&quot;shapefiles&quot;)</span></code> 则是 shp 文件的使用指南，<code class="docutils literal"><span class="pre">vignette(&quot;gstat&quot;)</span></code> 对应一个包含克里格插值在内的空间插值功能包。</p>
</div>
<div class="section" id="id7">
<h2>其它信息<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>　　对于 R 的一般介绍，请查看 <a class="reference external" href="http://cran.r-project.org/doc/manuals/R-intro.html">官方简介</a> 或 <a class="reference external" href="http://www.r-project.org/">R Project</a> 的任何文档。</p>
<p>　　对于其空间操作功能，建议阅读 <a class="reference external" href="http://cran.r-project.org/web/views/Spatial.html">R Spatial Task View</a> 。</p>
<p>　　浏览 <a class="reference external" href="http://r-spatial.sourceforge.net/">R-Spatial</a> 可以获得更多项目信息以及 R-sig-Geo 邮件列表的信息。</p>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
	<font size="-2">
		<div id="translations">
		<!--
			<a href="../../en/index.html">English</a> |
			<a href="../../es/index.html">Español</a> |
			<a href="../../ca/index.html">Català</a> |
			<a href="../../fr/index.html">Français</a> |
			<a href="../../de/index.html">Deutsch</a> |
			<a href="../../it/index.html">Italiano</a> |
			<a href="../../pl/index.html">Polski</a> |
			<a href="../../el/index.html">Ελληνικά</a> |
			<a href="../../ru/index.html">Русский</a> |
			<a href="../../zh/index.html">中文</a> |
			<a href="../../id/index.html">Bahasa Indonesia</a> |
			<a href="../../ko/index.html">한국어</a> |
			<a href="../../ja/index.html">日本語</a>
		-->
		<!-- geo-order: West to East, UK to Japan -->
			<a href="javascript:defaultRedirect('en')">English</a> |
<!--			<a href="javascript:defaultRedirect('pt')">Portugus</a> | -->
			<a href="javascript:defaultRedirect('es')">Español</a> |
			<a href="javascript:defaultRedirect('ca')">Català</a> |
			<a href="javascript:defaultRedirect('fr')">Français</a> |
			<a href="javascript:defaultRedirect('de')">Deutsch</a> |
			<a href="javascript:defaultRedirect('it')">Italiano</a> |
			<a href="javascript:defaultRedirect('pl')">Polski</a> |
			<a href="javascript:defaultRedirect('el')">Ελληνικά</a> |
			<a href="javascript:defaultRedirect('ru')">Русский</a> |
			<a href="javascript:defaultRedirect('zh')">中文</a> |
<!--			<a href="javascript:defaultRedirect('id')">Bahasa Indonesia</a> | -->
			<a href="javascript:defaultRedirect('ko')">한국어</a> |
			<a href="javascript:defaultRedirect('ja')">日本語</a>
		</div>
	</font>
    </div>

<span style="font-size:85%;"><i><a href="../copyright.html">Copyright & Disclaimer</a></i></span>

  </body>
</html>