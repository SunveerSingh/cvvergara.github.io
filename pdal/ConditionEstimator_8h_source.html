<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>PDAL: pdal/vendor/eigen/Eigen/src/Core/ConditionEstimator.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PDAL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ConditionEstimator_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ConditionEstimator.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ConditionEstimator_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// This file is part of Eigen, a lightweight C++ template library</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// for linear algebra.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Copyright (C) 2016 Rasmus Munk Larsen (rmlarsen@google.com)</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// This Source Code Form is subject to the terms of the Mozilla</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Public License v. 2.0. If a copy of the MPL was not distributed</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#ifndef EIGEN_CONDITIONESTIMATOR_H</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#define EIGEN_CONDITIONESTIMATOR_H</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceEigen.html">Eigen</a> {</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceinternal.html">internal</a> {</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Vector, <span class="keyword">typename</span> RealVector, <span class="keywordtype">bool</span> IsComplex&gt;</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="structEigen_1_1internal_1_1rcond__compute__sign.html">   18</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structEigen_1_1internal_1_1rcond__compute__sign.html">rcond_compute_sign</a> {</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="structEigen_1_1internal_1_1rcond__compute__sign.html#a0c1e067cca0d2d9884c310fb86388361">   19</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">inline</span> Vector <a class="code" href="structEigen_1_1internal_1_1rcond__compute__sign.html#a0c1e067cca0d2d9884c310fb86388361">run</a>(<span class="keyword">const</span> Vector&amp; <a class="code" href="namespaceanonymous__namespace_02path__unit__test_8cpp_03.html#ae32ae5a8dbfa8b65f75e552c99082046">v</a>) {</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keyword">const</span> RealVector v_abs = v.cwiseAbs();</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">return</span> (v_abs.array() == <span class="keyword">static_cast&lt;</span>typename Vector::RealScalar<span class="keyword">&gt;</span>(0))</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;            .select(Vector::Ones(v.size()), v.cwiseQuotient(v_abs));</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  }</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;};</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// Partial specialization to avoid elementwise division for real vectors.</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Vector&gt;</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="structEigen_1_1internal_1_1rcond__compute__sign_3_01Vector_00_01Vector_00_01false_01_4.html">   28</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structEigen_1_1internal_1_1rcond__compute__sign.html">rcond_compute_sign</a>&lt;Vector, Vector, <a class="code" href="breaking__changes_8txt.html#aff82174fdf596db77ed5ac8e18ace9cd">false</a>&gt; {</div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structEigen_1_1internal_1_1rcond__compute__sign_3_01Vector_00_01Vector_00_01false_01_4.html#a74f76e8aa6893b263c4531e40094cbf2">   29</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">inline</span> Vector <a class="code" href="structEigen_1_1internal_1_1rcond__compute__sign_3_01Vector_00_01Vector_00_01false_01_4.html#a74f76e8aa6893b263c4531e40094cbf2">run</a>(<span class="keyword">const</span> Vector&amp; <a class="code" href="namespaceanonymous__namespace_02path__unit__test_8cpp_03.html#ae32ae5a8dbfa8b65f75e552c99082046">v</a>) {</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">return</span> (v.array() &lt; <span class="keyword">static_cast&lt;</span>typename Vector::RealScalar<span class="keyword">&gt;</span>(0))</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;           .select(-Vector::Ones(v.size()), Vector::Ones(v.size()));</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  }</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;};</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">  * \returns an estimate of ||inv(matrix)||_1 given a decomposition of</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">  * \a matrix that implements .solve() and .adjoint().solve() methods.</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">  *</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">  * This function implements Algorithms 4.1 and 5.1 from</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">  *   http://www.maths.manchester.ac.uk/~higham/narep/narep135.pdf</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">  * which also forms the basis for the condition number estimators in</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">  * LAPACK. Since at most 10 calls to the solve method of dec are</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">  * performed, the total cost is O(dims^2), as opposed to O(dims^3)</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">  * needed to compute the inverse matrix explicitly.</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">  *</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">  * The most common usage is in estimating the condition number</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">  * ||matrix||_1 * ||inv(matrix)||_1. The first term ||matrix||_1 can be</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">  * computed directly in O(n^2) operations.</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">  *</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">  * Supports the following decompositions: FullPivLU, PartialPivLU, LDLT, and</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">  * LLT.</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">  *</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">  * \sa FullPivLU, PartialPivLU, LDLT, LLT.</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Decomposition&gt;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="namespaceEigen_1_1internal.html#aa3f5b3cfa34df750994a247d4823aa51">   56</a></span>&#160;<span class="keyword">typename</span> Decomposition::RealScalar <a class="code" href="namespaceEigen_1_1internal.html#aa3f5b3cfa34df750994a247d4823aa51">rcond_invmatrix_L1_norm_estimate</a>(<span class="keyword">const</span> Decomposition&amp; dec)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Decomposition::MatrixType MatrixType;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Decomposition::Scalar Scalar;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Decomposition::RealScalar RealScalar;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structEigen_1_1internal_1_1true__type.html">internal::plain_col_type&lt;MatrixType&gt;::type</a> Vector;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structEigen_1_1internal_1_1true__type.html">internal::plain_col_type&lt;MatrixType, RealScalar&gt;::type</a> RealVector;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> is_complex = (<a class="code" href="structEigen_1_1NumTraits.html">NumTraits&lt;Scalar&gt;::IsComplex</a> != 0);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="Core_2util_2Macros_8h.html#acaa7ba89800cfe18d5fd6eed620aea9c">eigen_assert</a>(dec.rows() == dec.cols());</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="post__review__plan_8txt.html#a36bde34ae3d6f749c937ab8ff9f6c807">n</a> = dec.rows();</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">if</span> (n == 0)</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// Disable Index to float conversion warning</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#ifdef __INTEL_COMPILER</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">  #pragma warning push</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">  #pragma warning ( disable : 2259 )</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  Vector <a class="code" href="namespaceanonymous__namespace_02path__unit__test_8cpp_03.html#ae32ae5a8dbfa8b65f75e552c99082046">v</a> = dec.solve(Vector::Ones(n) / Scalar(n));</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#ifdef __INTEL_COMPILER</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">  #pragma warning pop</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">// lower_bound is a lower bound on</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">//   ||inv(matrix)||_1  = sup_v ||inv(matrix) v||_1 / ||v||_1</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">// and is the objective maximized by the (&quot;super-&quot;) gradient ascent</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// algorithm below.</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  RealScalar <a class="code" href="namespacepdalboost_1_1range.html#a687cec7972a274f912839f92f6da26cd">lower_bound</a> = v.template lpNorm&lt;1&gt;();</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (n == 1)</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacepdalboost_1_1range.html#a687cec7972a274f912839f92f6da26cd">lower_bound</a>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// Gradient ascent algorithm follows: We know that the optimum is achieved at</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// one of the simplices v = e_i, so in each iteration we follow a</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// super-gradient to move towards the optimal one.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  RealScalar old_lower_bound = <a class="code" href="namespacepdalboost_1_1range.html#a687cec7972a274f912839f92f6da26cd">lower_bound</a>;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  Vector sign_vector(n);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  Vector old_sign_vector;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> v_max_abs_index = -1;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> old_v_max_abs_index = v_max_abs_index;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceARBITER__CUSTOM__NAMESPACE_1_1arbiter_1_1crypto_1_1anonymous__namespace_02arbiter_8cpp_03.html#afc13e166b3547bd8d4beb386d2b47dc7">k</a> = 0; <a class="code" href="namespaceARBITER__CUSTOM__NAMESPACE_1_1arbiter_1_1crypto_1_1anonymous__namespace_02arbiter_8cpp_03.html#afc13e166b3547bd8d4beb386d2b47dc7">k</a> &lt; 4; ++<a class="code" href="namespaceARBITER__CUSTOM__NAMESPACE_1_1arbiter_1_1crypto_1_1anonymous__namespace_02arbiter_8cpp_03.html#afc13e166b3547bd8d4beb386d2b47dc7">k</a>)</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    sign_vector = <a class="code" href="structEigen_1_1internal_1_1rcond__compute__sign.html#a0c1e067cca0d2d9884c310fb86388361">internal::rcond_compute_sign&lt;Vector, RealVector, is_complex&gt;::run</a>(v);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceARBITER__CUSTOM__NAMESPACE_1_1arbiter_1_1crypto_1_1anonymous__namespace_02arbiter_8cpp_03.html#afc13e166b3547bd8d4beb386d2b47dc7">k</a> &gt; 0 &amp;&amp; !is_complex &amp;&amp; sign_vector == old_sign_vector) {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="comment">// Break if the solution stagnated.</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// v_max_abs_index = argmax |real( inv(matrix)^T * sign_vector )|</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    v = dec.adjoint().solve(sign_vector);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    v.real().cwiseAbs().maxCoeff(&amp;v_max_abs_index);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> (v_max_abs_index == old_v_max_abs_index) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="comment">// Break if the solution stagnated.</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// Move to the new simplex e_j, where j = v_max_abs_index.</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    v = dec.solve(Vector::Unit(n, v_max_abs_index));  <span class="comment">// v = inv(matrix) * e_j.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    lower_bound = v.template lpNorm&lt;1&gt;();</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span> (lower_bound &lt;= old_lower_bound) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="comment">// Break if the gradient step did not increase the lower_bound.</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (!is_complex) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      old_sign_vector = sign_vector;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    old_v_max_abs_index = v_max_abs_index;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    old_lower_bound = <a class="code" href="namespacepdalboost_1_1range.html#a687cec7972a274f912839f92f6da26cd">lower_bound</a>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">// The following calculates an independent estimate of ||matrix||_1 by</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">// multiplying matrix by a vector with entries of slowly increasing</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// magnitude and alternating sign:</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">//   v_i = (-1)^{i} (1 + (i / (dim-1))), i = 0,...,dim-1.</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// This improvement to Hager&#39;s algorithm above is due to Higham. It was</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// added to make the algorithm more robust in certain corner cases where</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">// large elements in the matrix might otherwise escape detection due to</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">// exact cancellation (especially when op and op_adjoint correspond to a</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// sequence of backsubstitutions and permutations), which could cause</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">// Hager&#39;s algorithm to vastly underestimate ||matrix||_1.</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  Scalar alternating_sign(RealScalar(1));</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Index</a> <a class="code" href="gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = 0; <a class="code" href="gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &lt; <a class="code" href="post__review__plan_8txt.html#a36bde34ae3d6f749c937ab8ff9f6c807">n</a>; ++<a class="code" href="gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// The static_cast is needed when Scalar is a complex and RealScalar implements expression templates</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    v[<a class="code" href="gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>] = alternating_sign * <span class="keyword">static_cast&lt;</span>RealScalar<span class="keyword">&gt;</span>(RealScalar(1) + (RealScalar(<a class="code" href="gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) / (RealScalar(n - 1))));</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    alternating_sign = -alternating_sign;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  v = dec.solve(v);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keyword">const</span> RealScalar alternate_lower_bound = (2 * v.template lpNorm&lt;1&gt;()) / (3 * RealScalar(n));</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">return</span> numext::maxi(lower_bound, alternate_lower_bound);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">/** \brief Reciprocal condition number estimator.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">  *</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">  * Computing a decomposition of a dense matrix takes O(n^3) operations, while</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">  * this method estimates the condition number quickly and reliably in O(n^2)</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">  * operations.</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">  *</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">  * \returns an estimate of the reciprocal condition number</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">  * (1 / (||matrix||_1 * ||inv(matrix)||_1)) of matrix, given ||matrix||_1 and</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">  * its decomposition. Supports the following decompositions: FullPivLU,</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">  * PartialPivLU, LDLT, and LLT.</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">  *</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">  * \sa FullPivLU, PartialPivLU, LDLT, LLT.</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Decomposition&gt;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keyword">typename</span> Decomposition::RealScalar</div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="namespaceEigen_1_1internal.html#ad1de0d785387bfb5435c410bf0554068">  159</a></span>&#160;<a class="code" href="namespaceEigen_1_1internal.html#ad1de0d785387bfb5435c410bf0554068">rcond_estimate_helper</a>(<span class="keyword">typename</span> Decomposition::RealScalar matrix_norm, <span class="keyword">const</span> Decomposition&amp; dec)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Decomposition::RealScalar RealScalar;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="Core_2util_2Macros_8h.html#acaa7ba89800cfe18d5fd6eed620aea9c">eigen_assert</a>(dec.rows() == dec.cols());</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">if</span> (dec.rows() == 0)              <span class="keywordflow">return</span> RealScalar(1);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">if</span> (matrix_norm == RealScalar(0)) <span class="keywordflow">return</span> RealScalar(0);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">if</span> (dec.rows() == 1)              <span class="keywordflow">return</span> RealScalar(1);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keyword">const</span> RealScalar inverse_matrix_norm = <a class="code" href="namespaceEigen_1_1internal.html#aa3f5b3cfa34df750994a247d4823aa51">rcond_invmatrix_L1_norm_estimate</a>(dec);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">return</span> (inverse_matrix_norm == RealScalar(0) ? RealScalar(0)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                               : (RealScalar(1) / inverse_matrix_norm) / matrix_norm);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}  <span class="comment">// namespace internal</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}  <span class="comment">// namespace Eigen</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="post__review__plan_8txt_html_a36bde34ae3d6f749c937ab8ff9f6c807"><div class="ttname"><a href="post__review__plan_8txt.html#a36bde34ae3d6f749c937ab8ff9f6c807">n</a></div><div class="ttdeci">desc n</div><div class="ttdef"><b>Definition:</b> <a href="post__review__plan_8txt_source.html#l00065">post_review_plan.txt:65</a></div></div>
<div class="ttc" id="namespacepdalboost_1_1range_html_a687cec7972a274f912839f92f6da26cd"><div class="ttname"><a href="namespacepdalboost_1_1range.html#a687cec7972a274f912839f92f6da26cd">pdalboost::range::lower_bound</a></div><div class="ttdeci">BOOST_DEDUCED_TYPENAME disable_if&lt; is_const&lt; ForwardRange &gt;, BOOST_DEDUCED_TYPENAME range_iterator&lt; ForwardRange &gt;::type &gt;::type lower_bound(ForwardRange &amp;rng, Value val)</div><div class="ttdoc">template function lower_bound </div><div class="ttdef"><b>Definition:</b> <a href="lower__bound_8hpp_source.html#l00034">lower_bound.hpp:34</a></div></div>
<div class="ttc" id="namespaceEigen_html"><div class="ttname"><a href="namespaceEigen.html">Eigen</a></div><div class="ttdef"><b>Definition:</b> <a href="LDLT_8h_source.html#l00016">LDLT.h:16</a></div></div>
<div class="ttc" id="structEigen_1_1NumTraits_html"><div class="ttname"><a href="structEigen_1_1NumTraits.html">Eigen::NumTraits</a></div><div class="ttdoc">Holds information about the various numeric (i.e. scalar) types allowed by Eigen. ...</div><div class="ttdef"><b>Definition:</b> <a href="NumTraits_8h_source.html#l00150">NumTraits.h:150</a></div></div>
<div class="ttc" id="namespaceEigen_1_1internal_html_ad1de0d785387bfb5435c410bf0554068"><div class="ttname"><a href="namespaceEigen_1_1internal.html#ad1de0d785387bfb5435c410bf0554068">Eigen::internal::rcond_estimate_helper</a></div><div class="ttdeci">Decomposition::RealScalar rcond_estimate_helper(typename Decomposition::RealScalar matrix_norm, const Decomposition &amp;dec)</div><div class="ttdoc">Reciprocal condition number estimator. </div><div class="ttdef"><b>Definition:</b> <a href="ConditionEstimator_8h_source.html#l00159">ConditionEstimator.h:159</a></div></div>
<div class="ttc" id="namespaceanonymous__namespace_02path__unit__test_8cpp_03_html_ae32ae5a8dbfa8b65f75e552c99082046"><div class="ttname"><a href="namespaceanonymous__namespace_02path__unit__test_8cpp_03.html#ae32ae5a8dbfa8b65f75e552c99082046">anonymous_namespace{path_unit_test.cpp}::v</a></div><div class="ttdeci">std::vector&lt; char &gt; v</div><div class="ttdef"><b>Definition:</b> <a href="path__unit__test_8cpp_source.html#l00141">path_unit_test.cpp:141</a></div></div>
<div class="ttc" id="breaking__changes_8txt_html_aff82174fdf596db77ed5ac8e18ace9cd"><div class="ttname"><a href="breaking__changes_8txt.html#aff82174fdf596db77ed5ac8e18ace9cd">false</a></div><div class="ttdeci">Version See you have to change your code although it could easily be defaulted based on and the path before the data when the path is something you will very rarely want to by separating along the lines of the do_not_replace parameter you have to change your code false</div><div class="ttdef"><b>Definition:</b> <a href="breaking__changes_8txt_source.html#l00020">breaking_changes.txt:20</a></div></div>
<div class="ttc" id="namespaceARBITER__CUSTOM__NAMESPACE_1_1arbiter_1_1crypto_1_1anonymous__namespace_02arbiter_8cpp_03_html_afc13e166b3547bd8d4beb386d2b47dc7"><div class="ttname"><a href="namespaceARBITER__CUSTOM__NAMESPACE_1_1arbiter_1_1crypto_1_1anonymous__namespace_02arbiter_8cpp_03.html#afc13e166b3547bd8d4beb386d2b47dc7">ARBITER_CUSTOM_NAMESPACE::arbiter::crypto::anonymous_namespace{arbiter.cpp}::k</a></div><div class="ttdeci">const std::vector&lt; uint32_t &gt; k</div><div class="ttdef"><b>Definition:</b> <a href="arbiter_8cpp_source.html#l03571">arbiter.cpp:3571</a></div></div>
<div class="ttc" id="namespaceEigen_html_a62e77e0933482dafde8fe197d9a2cfde"><div class="ttname"><a href="namespaceEigen.html#a62e77e0933482dafde8fe197d9a2cfde">Eigen::Index</a></div><div class="ttdeci">EIGEN_DEFAULT_DENSE_INDEX_TYPE Index</div><div class="ttdoc">The Index type as used for the API. </div><div class="ttdef"><b>Definition:</b> <a href="Core_2util_2Meta_8h_source.html#l00033">Meta.h:33</a></div></div>
<div class="ttc" id="gtest__output__test__golden__lin_8txt_html_a7e98b8a17c0aad30ba64d47b74e2a6c1"><div class="ttname"><a href="gtest__output__test__golden__lin_8txt.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="gtest__output__test__golden__lin_8txt_source.html#l00072">gtest_output_test_golden_lin.txt:72</a></div></div>
<div class="ttc" id="namespaceinternal_html"><div class="ttname"><a href="namespaceinternal.html">internal</a></div><div class="ttdef"><b>Definition:</b> <a href="Eigen__Colamd_8h_source.html#l00050">Eigen_Colamd.h:50</a></div></div>
<div class="ttc" id="structEigen_1_1internal_1_1rcond__compute__sign_html_a0c1e067cca0d2d9884c310fb86388361"><div class="ttname"><a href="structEigen_1_1internal_1_1rcond__compute__sign.html#a0c1e067cca0d2d9884c310fb86388361">Eigen::internal::rcond_compute_sign::run</a></div><div class="ttdeci">static Vector run(const Vector &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="ConditionEstimator_8h_source.html#l00019">ConditionEstimator.h:19</a></div></div>
<div class="ttc" id="namespaceEigen_1_1internal_html_aa3f5b3cfa34df750994a247d4823aa51"><div class="ttname"><a href="namespaceEigen_1_1internal.html#aa3f5b3cfa34df750994a247d4823aa51">Eigen::internal::rcond_invmatrix_L1_norm_estimate</a></div><div class="ttdeci">Decomposition::RealScalar rcond_invmatrix_L1_norm_estimate(const Decomposition &amp;dec)</div><div class="ttdef"><b>Definition:</b> <a href="ConditionEstimator_8h_source.html#l00056">ConditionEstimator.h:56</a></div></div>
<div class="ttc" id="Core_2util_2Macros_8h_html_acaa7ba89800cfe18d5fd6eed620aea9c"><div class="ttname"><a href="Core_2util_2Macros_8h.html#acaa7ba89800cfe18d5fd6eed620aea9c">eigen_assert</a></div><div class="ttdeci">#define eigen_assert(x)</div><div class="ttdef"><b>Definition:</b> <a href="Core_2util_2Macros_8h_source.html#l00577">Macros.h:577</a></div></div>
<div class="ttc" id="structEigen_1_1internal_1_1true__type_html"><div class="ttname"><a href="structEigen_1_1internal_1_1true__type.html">Eigen::internal::true_type</a></div><div class="ttdef"><b>Definition:</b> <a href="Core_2util_2Meta_8h_source.html#l00054">Meta.h:54</a></div></div>
<div class="ttc" id="structEigen_1_1internal_1_1rcond__compute__sign_html"><div class="ttname"><a href="structEigen_1_1internal_1_1rcond__compute__sign.html">Eigen::internal::rcond_compute_sign</a></div><div class="ttdef"><b>Definition:</b> <a href="ConditionEstimator_8h_source.html#l00018">ConditionEstimator.h:18</a></div></div>
<div class="ttc" id="structEigen_1_1internal_1_1rcond__compute__sign_3_01Vector_00_01Vector_00_01false_01_4_html_a74f76e8aa6893b263c4531e40094cbf2"><div class="ttname"><a href="structEigen_1_1internal_1_1rcond__compute__sign_3_01Vector_00_01Vector_00_01false_01_4.html#a74f76e8aa6893b263c4531e40094cbf2">Eigen::internal::rcond_compute_sign&lt; Vector, Vector, false &gt;::run</a></div><div class="ttdeci">static Vector run(const Vector &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="ConditionEstimator_8h_source.html#l00029">ConditionEstimator.h:29</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_a542be5b8e919f24a4504a2b5a97aa0f.html">pdal</a></li><li class="navelem"><a class="el" href="dir_d33d266033e67ebd052ba765e5bff9d3.html">vendor</a></li><li class="navelem"><a class="el" href="dir_d3409df3635d473579a0f9f132d6bc7d.html">eigen</a></li><li class="navelem"><a class="el" href="dir_0f08285df9f9b912ca842d1cac6e52f6.html">Eigen</a></li><li class="navelem"><a class="el" href="dir_15c81199740aa5e36eb438f84fa9500c.html">src</a></li><li class="navelem"><a class="el" href="dir_f7c3649d37df64b2473548c7f049b39b.html">Core</a></li><li class="navelem"><a class="el" href="ConditionEstimator_8h.html">ConditionEstimator.h</a></li>
    <li class="footer">Generated on Fri Dec 22 2017 14:44:51 for PDAL by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
